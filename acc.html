<!DOCTYPE html>
<html lang="fr">
<head>  
<meta name="robots" content="noindex, nofollow">
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/> 
<title>Portefeuille - Vantex</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
    /* PAGE SCROLLABLE */
    html, body {
        overflow-y: auto;
        height: 100%;
        margin: 0;
        padding: 0;
    }
    *, *::before, *::after {
        box-sizing: border-box;
    }
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f9fbfc;
        margin: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        padding: 10px 10px 70px;
        color: #222;
    }

    /* ========== HEADER ========== */
    #topHeader {
      width: 100%;
      max-width: 400px;
      margin: 0 auto 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 10px 5px;
      background-color: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgb(0 0 0 / 0.07);
      box-sizing: border-box;
      flex-shrink: 0;
      position: sticky;
      top: 0;
      z-index: 200;
    }

    .logo-container img {
      height: 60px;  /* agrandi */
      width: auto;
      user-select: none;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .user-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: #1976d2;
      color: white;
      font-weight: 700;
      font-size: 16px;
      line-height: 40px;
      text-align: center;
      cursor: pointer;
      user-select: none;
      position: relative;
      overflow: hidden;
      flex-shrink: 0;
    }

    .user-icon img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
    }

    .user-icon:focus {
      outline: 2px solid #0d47a1;
      outline-offset: 2px;
    }

    /* Notification */
    .notif-wrapper {
      position: relative;
      flex-shrink: 0;
    }

    #notificationBtn {
      background: none;
      border: none;
      cursor: pointer;
      color: #1976d2;
      font-size: 22px;
      position: relative;
      padding: 0;
      user-select: none;
    }

    #notificationBtn:focus {
      outline: 2px solid #0d47a1;
      outline-offset: 2px;
    }

    /* Badge notification */
    .notif-badge {
      position: absolute;
      top: -4px;
      right: -6px;
      background-color: #d32f2f;
      color: white;
      font-size: 10px;
      font-weight: 700;
      padding: 2px 5px;
      border-radius: 12px;
      min-width: 18px;
      text-align: center;
      line-height: 1;
    }

    /* Notification list */
    .notification-list {
      position: fixed; /* FIXÉ pour être visible sur scroll */
      top: 70px; /* juste sous le header */
      right: 10px;
      background: white;
      box-shadow: 0 4px 12px rgb(0 0 0 / 0.12);
      border-radius: 8px;
      width: 280px;
      max-height: 250px;
      overflow-y: auto;
      padding: 10px;
      font-size: 14px;
      color: #222;
      user-select: none;
      z-index: 250;
      display: none; /* masqué par défaut */
    }

    .notification-list ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .notification-list li {
      padding: 6px 8px;
      border-bottom: 1px solid #eee;
    }

    .notification-list li:last-child {
      border-bottom: none;
    }
    /* ===== FIN HEADER ===== */

    .welcome-container {
        background-color: #fff;
        max-width: 400px;
        width: 100%;
        border-radius: 12px;
        padding: 15px 20px 15px;
        box-shadow: 0 4px 12px rgb(0 0 0 / 0.07);
        margin-bottom: 15px;
        text-align: center;
        color: #2e2e2e;
        flex-shrink: 0;
    }
    .welcome-container h1 {
        font-weight: 700;
        font-size: 22px;
        margin: 0 0 6px 0;
        color: #1976d2;
    }
    .welcome-container p {
        font-size: 14px;
        margin: 0;
        font-style: normal;
        color: #555;
    }
    #portefeuilleSection {
        background-color: #fff;
        max-width: 400px;
        width: 100%;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgb(0 0 0 / 0.08);
        padding: 20px 20px 20px;
        overflow: hidden;
        flex-shrink: 0;
    }
    #portefeuilleSection .solde-label {
        font-weight: 600;
        font-size: 14px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        color: #333333;
        margin-bottom: 4px;
    }
    #portefeuilleSection .solde-label .check-icon {
        color: #1976d2;
        font-size: 18px;
    }
    #portefeuilleSection .solde-montant {
        font-size: 30px;
        font-weight: 700;
        color: #000;
        margin: 0 0 12px 0;
        letter-spacing: 0.04em;
    }
    #portefeuilleSection .description {
        font-style: normal;
        font-weight: 400;
        font-size: 13px;
        color: #666666;
        margin-bottom: 18px;
    }
    .actions {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 20px;
    }
    .actions button {
        flex: 1 1 130px;
        background-color: #f2f8ff;
        border: none;
        border-radius: 12px;
        padding: 9px 16px;
        font-size: 13px;
        font-weight: 600;
        color: #1976d2;
        display: inline-flex;
        align-items: center;
        gap: 7px;
        cursor: pointer;
        box-shadow: 0 3px 6px rgb(25 118 210 / 0.15);
    }
    .actions button:hover, .actions button:focus {
        background-color: #e3f2fd;
        outline: none;
        color: #0d47a1;
        box-shadow: 0 5px 12px rgb(13 71 161 / 0.3);
    }
    .actions button i {
        font-size: 16px;
    }
    .transaction-history > h4 {
        font-weight: 700;
        font-size: 16px;
        margin-bottom: 15px;
        color: #333;
        display: flex;
        align-items: center;
        gap: 6px;
        white-space: nowrap;
    }
    .transaction-history > h4 i {
        color: #1976d2;
        font-size: 20px;
    }
    .transaction-history {
        max-height: 190px; /* limiter hauteur historique pour pas déborder */
        overflow: hidden; /* on cache le scroll */
    }
    .transaction {
        border-radius: 10px;
        background-color: #f9fafb;
        padding: 12px 16px;
        margin-bottom: 14px;
        box-shadow: 0 1px 4px rgb(0 0 0 / 0.05);
        display: flex;
        justify-content: space-between;
        align-items: center;
        user-select: none;
    }
    .transaction .details {
        flex: 1;
        min-width: 0;
    }
    .transaction .details .desc {
        font-weight: 600;
        font-size: 14px;
        color: #222222;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        margin-bottom: 4px;
        display: flex;
        align-items: center;
        gap: 6px;
    }
    .transaction .details .desc i {
        font-size: 16px;
    }
    .transaction .details .date {
        font-size: 12px;
        color: #777777;
    }
    .transaction .amount {
        font-weight: 700;
        font-size: 14px;
        min-width: 110px;
        text-align: right;
        white-space: nowrap;
    }
    .transaction.sent {
        background-color: #ffeded;
        border: 1px solid #f5a1a1;
    }
    .transaction.sent .desc i {
        color: #d32f2f;
    }
    .transaction.sent .amount {
        color: #d32f2f;
    }
    .transaction.received {
        background-color: #e6f4ea;
        border: 1px solid #a3d4a5;
    }
    .transaction.received .desc i {
        color: #388e3c;
    }
    .transaction.received .amount {
        color: #388e3c;
    }
    .footer-icons {
        display: flex;
        justify-content: space-around;
        align-items: center;
        position: fixed;
        bottom: 0;
        width: 100%;
        max-width: 100vw;
        background-color: #fff;
        box-shadow: 0 -3px 10px rgb(0 0 0 / 0.12);
        padding: 10px 5px;
        z-index: 10;
        flex-shrink: 0;
    }
    .footer-icons div {
        text-align: center;
        flex-grow: 1;
        cursor: pointer;
        border-radius: 8px;
        padding: 5px 0;
        color: #1976d2;
        transition: background-color 0.3s ease;
        user-select: none;
    }
    .footer-icons div.active {
        background-color: #1976d2;
        color: white;
        font-weight: 700;
        box-shadow: 0 0 10px rgb(25 118 210 / 0.6);
    }
    .footer-icons div:hover:not(.active) {
        background-color: #e3f2fd;
    }
    .footer-icons i {
        font-size: 24px;
        pointer-events: none;
    }
    .footer-icons span {
        display: block;
        font-size: 13px;
        margin-top: 5px;
        user-select: none;
    }
    /* Styles pour modales : empêcher scroll dans le fond */
    .modal {
        overflow: hidden !important;
    }
</style>
</head>
<body>
<!-- Champ email caché -->
<input type="hidden" id="email" value="lpgr31@gmail.com" />

<!-- HEADER avec logo + icones -->
<header id="topHeader" role="banner" aria-label="En-tête du site">
  <div class="logo-container">
    <img src="https://raw.githubusercontent.com/Walyy578/ONLINE-BANKING/main/Design%20sans%20titre%20(2).png" alt="Logo BDE" />
  </div>
  <div class="header-right">
    <div id="notification-container" class="notif-wrapper" tabindex="0" aria-label="Notifications" role="region" aria-live="polite">
      <button id="notificationBtn" aria-haspopup="true" aria-expanded="false" aria-controls="notificationList" aria-label="Afficher les notifications">
        <i class="fas fa-bell"></i>
        <span id="notif-badge" class="notif-badge" aria-hidden="true" style="display:none;">0</span>
      </button>
      <div id="notificationList" class="notification-list" role="region" aria-label="Liste des notifications" hidden>
        <ul id="notificationItems">
          <li>Bienvenue sur votre tableau de bord !</li>
          <li>Votre solde a été mis à jour.</li>
          <li>Nouvelle offre disponible.</li>
        </ul>
      </div>
    </div>
    <div id="userIcon" class="user-icon" tabindex="0" role="button" aria-label="Profil utilisateur. Cliquez pour modifier la photo">
      <span id="userInitials"></span>
      <img id="userPhoto" alt="Photo de profil" style="display:none;"/>
      <input type="file" id="photoUpload" accept="image/*" style="display:none" aria-label="Chargement d'une nouvelle photo de profil"/>
    </div>
  </div>
</header>

<div class="welcome-container" role="region" aria-label="Message de bienvenue" tabindex="0">
    <h1>Bienvenue, <span id="user-name">Utilisateur</span> !</h1>
    <p>Votre inscription a été réussie. Félicitations !</p>
</div>
<div id="portefeuilleSection" aria-label="Portefeuille et historique des transactions" role="main" tabindex="0">
    <p class="solde-label">
        Solde disponible
        <i class="fas fa-circle-check check-icon" aria-hidden="true" title="Solde vérifié"></i>
    </p>
    <p class="solde-montant" aria-live="polite" aria-atomic="true">0,00 Rs</p>
    <p class="description">Compte pour tous vos besoins</p>
    <div class="actions" role="group" aria-label="Actions du portefeuille">
        <button id="btnVoirIban" aria-label="Voir mon IBAN">
            <i class="fas fa-file-invoice"></i> Voir mon IBAN
        </button>
        <button id="btnEffectuerVirement" aria-label="Effectuer un virement sortant">
            <i class="fas fa-arrow-up-right-from-square"></i> Effectuer un virement
        </button>
        <button id="btnVoirCarteVirtuelle" aria-label="Voir ma carte virtuelle">
            <i class="fas fa-credit-card"></i> Voir ma carte virtuelle
        </button>
    </div>
    <div class="transaction-history" aria-live="polite" aria-label="Historique des transactions">
        <h4><i class="fas fa-clock-rotate-left" aria-hidden="true"></i> Historique des transactions</h4>
        <article class="transaction sent" tabindex="0" role="group" aria-label="Virement envoyé à Gerard, montant négatif - 200 000 Rs, date 4 avril 2025 à 07:31">
            <div class="details">
                <div class="desc"><i class="fas fa-arrow-up"></i> Virement envoyé à Gerard...</div>
                <div class="date">04/04/2025 • 07:31</div>
            </div>
            <div class="amount">- 200 000,00 Rs</div>
        </article>
        <article class="transaction received" tabindex="0" role="group" aria-label="Virement reçu de Vantex, montant positif +200 000 Rs, date 16 mars 2025 à 11:08">
            <div class="details">
                <div class="desc"><i class="fas fa-arrow-down"></i> Virement reçu de Vantex...</div>
                <div class="date">16/03/2025 • 11:08</div>
            </div>
            <div class="amount">+ 200 000,00 Rs</div>
        </article>
    </div>
</div>
<nav class="footer-icons" role="navigation" aria-label="Menu principal">
    <div id="portefeuilleBtn" class="active" tabindex="0" role="button" aria-pressed="true" aria-label="Portefeuille">
        <i class="fas fa-wallet" aria-hidden="true"></i>
        <span>Portefeuille</span>
    </div>
    <div id="virementBtn" tabindex="0" role="button" aria-label="Virement">
        <i class="fas fa-exchange-alt" aria-hidden="true"></i>
        <span>Virement</span>
    </div>
    <div id="virtualCardBtn" tabindex="0" role="button" aria-label="Carte virtuelle">
        <i class="fas fa-credit-card" aria-hidden="true"></i>
        <span>Carte virtuelle</span>
    </div>
    <div id="monCompteBtn" tabindex="0" role="button" aria-label="Mon compte">
        <i class="fas fa-user-circle" aria-hidden="true"></i>
        <span>Mon compte</span>
    </div>
</nav>
<!-- Modales -->
<div id="virtualCardModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="virtualCardTitle" style="display:none; justify-content:center; align-items:center; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); z-index:100;">
    <div class="modal-content" style="max-width:500px; max-height:80vh; overflow-y:auto; background:#fff; border-radius:20px; padding:20px; margin:auto; text-align:center; box-shadow:0 8px 16px rgb(0 0 0 / 0.3);">
        <h3 id="virtualCardTitle" style="color:#1976d2; margin-bottom:20px;">Carte virtuelle</h3>
        <img src="https://raw.githubusercontent.com/Walyy578/ONLINE-BANKING/main/InShot_20250608_193242344.jpg" alt="Carte virtuelle" style="width:100%; max-width: 300px; border-radius: 10px; margin-bottom:10px;">
        <p style="color:#b71c1c; font-weight:600; background:#fff9c4; padding:10px; border-radius: 5px;">Pour des raisons de sécurité, les 4 derniers chiffres de votre carte ont été masqués.</p>
        <button id="closeVirtualCardBtn" aria-label="Fermer la carte virtuelle" style="background:#d32f2f; border:none; padding:10px 25px; color:#fff; border-radius:8px; cursor:pointer; font-size:16px;">Fermer</button>
    </div>
</div>
<div id="myModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="monCompteTitle" style="display:none; justify-content:center; align-items:center; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); z-index:100;">
    <div class="modal-content" style="max-width:480px; max-height:80vh; overflow-y:auto; background:#fff; border-radius:20px; padding:20px; margin:auto; text-align:left; box-shadow:0 8px 16px rgb(0 0 0 / 0.3);">
        <h3 id="monCompteTitle" style="color:#1976d2; margin-bottom:20px; text-align:center;">Vos informations de compte :</h3>
        <p><strong>Type de Compte :</strong> Compte courant</p>
        <p><strong>Titulaire du Compte :</strong> RAMGOULAM LOUIS PAUL GERARD</p>
        <p><strong>Pays de résidence :</strong> Maurice</p>
        <p><strong>Adresse de résidence :</strong> ILE MAURICE 230</p>
        <p><strong>Adresse e-mail :</strong> lpgr31@gmail.com</p>
        <p><strong>Numéro de téléphone :</strong> +23057895689</p>
        <div style="display:flex; justify-content: space-between; margin-top: 25px;">
            <button id="btnSeDeconnecter" style="background:#d32f2f; color:#fff; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; flex:1; margin-right:10px;">Se déconnecter</button>
            <button id="btnCloseMyAccount" style="background:#1976d2; color:#fff; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; flex:1;">Retour</button>
        </div>
    </div>
</div>
<script>
    // Elements sélectionnés
    const portefeuilleBtn = document.getElementById("portefeuilleBtn");
    const virementBtn = document.getElementById("virementBtn");
    const virtualCardBtn = document.getElementById("virtualCardBtn");
    const monCompteBtn = document.getElementById("monCompteBtn");
    const portefeuilleSection = document.getElementById("portefeuilleSection");
    const virtualCardModal = document.getElementById("virtualCardModal");
    const closeVirtualCardBtn = document.getElementById("closeVirtualCardBtn");
    const myModal = document.getElementById("myModal");
    const btnSeDeconnecter = document.getElementById("btnSeDeconnecter");
    const btnCloseMyAccount = document.getElementById("btnCloseMyAccount");
    const btnVoirIban = document.getElementById("btnVoirIban");
    const btnEffectuerVirement = document.getElementById("btnEffectuerVirement");
    const btnVoirCarteVirtuelle = document.getElementById("btnVoirCarteVirtuelle");

    function deselectAll(){
        portefeuilleBtn.classList.remove("active");
        virementBtn.classList.remove("active");
        virtualCardBtn.classList.remove("active");
        monCompteBtn.classList.remove("active");
    }
    // Portefeuille affiche section principale
    portefeuilleBtn.onclick = () => {
        deselectAll();
        portefeuilleBtn.classList.add("active");
        portefeuilleSection.style.display = "block";
        virtualCardModal.style.display = "none";
        myModal.style.display = "none";
    };
    // Virement redirection (alerte supprimée)
    virementBtn.onclick = () => {
        window.location.href = "virement.html";
    };
    // Carte virtuelle montre modal
    virtualCardBtn.onclick = () => {
        deselectAll();
        virtualCardBtn.classList.add("active");
        virtualCardModal.style.display = "flex";
        portefeuilleSection.style.display = "none";
        myModal.style.display = "none";
    };
    closeVirtualCardBtn.onclick = () => {
        virtualCardModal.style.display = "none";
        deselectAll();
        portefeuilleBtn.classList.add("active");
        portefeuilleSection.style.display = "block";
    };
    // Mon compte montre modal
    monCompteBtn.onclick = () => {
        deselectAll();
        monCompteBtn.classList.add("active");
        myModal.style.display = "flex";
        portefeuilleSection.style.display = "none";
        virtualCardModal.style.display = "none";
    };
    btnCloseMyAccount.onclick = () => {
        myModal.style.display = "none";
        deselectAll();
        portefeuilleBtn.classList.add("active");
        portefeuilleSection.style.display = "block";
    };
    btnSeDeconnecter.onclick = () => {
        alert("Vous avez été déconnecté.");
        // window.location.href = "login.html";
    };
    // Voir IBAN ouvre modale Mon compte au lieu d'alerte
    btnVoirIban.onclick = () => {
        deselectAll();
        monCompteBtn.classList.add("active");
        myModal.style.display = "flex";
        portefeuilleSection.style.display = "none";
        virtualCardModal.style.display = "none";
    };
    // Effectuer virement continue redirection vers virement.html
    btnEffectuerVirement.onclick = () => {
        window.location.href = "virement.html";
    };
    // Voir carte virtuelle ouvre modal carte virtuelle
    btnVoirCarteVirtuelle.onclick = () => {
        deselectAll();
        virtualCardBtn.classList.add("active");
        virtualCardModal.style.display = "flex";
        portefeuilleSection.style.display = "none";
    };
    // Navigation clavier accessible sur footer
    [portefeuilleBtn, virementBtn, virtualCardBtn, monCompteBtn].forEach(btn => {
        btn.addEventListener("keydown", e => {
            if(e.key === "Enter" || e.key === " ") {
                e.preventDefault();
                btn.click();
            }
        });
    });

    /* === Gestion utilisateur + notifications === */
    document.addEventListener("DOMContentLoaded", () => {
      // Récupérer email
      const emailInput = document.getElementById("email");
      const email = emailInput ? emailInput.value.trim() : "";
      
      const userIcon = document.getElementById("userIcon");
      const userInitials = document.getElementById("userInitials");
      const userPhoto = document.getElementById("userPhoto");
      const photoUpload = document.getElementById("photoUpload");
      
      // Afficher les 2 premières lettres email en majuscule si email ok
      function getInitials(email) {
        if(!email) return "?";
        const namePart = email.split("@")[0];
        if(!namePart) return "?";
        return namePart.slice(0, 2).toUpperCase();
      }
      
      // Initialisation
      userInitials.textContent = getInitials(email);
      userPhoto.style.display = "none";

      // Gestion upload photo
      userIcon.addEventListener("click", () => {
        photoUpload.click();
      });

      // Support clavier: espace / entrée
      userIcon.addEventListener("keydown", e => {
        if(e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          photoUpload.click();
        }
      });

      photoUpload.addEventListener("change", () => {
        const file = photoUpload.files[0];
        if(file) {
          const reader = new FileReader();
          reader.onload = e => {
            userPhoto.src = e.target.result;
            userPhoto.style.display = "block";
            userInitials.textContent = "";
          };
          reader.readAsDataURL(file);
        }
      });

      // Notifications
      const notificationBtn = document.getElementById("notificationBtn");
      const notificationList = document.getElementById("notificationList");
      const notifBadge = document.getElementById("notif-badge");

      // Notifications modifiables ici :
      const notifications = [
        "Bienvenue sur votre tableau de bord !",
        "Votre solde a été mis à jour.",
        "Nouvelle offre disponible."
      ];

      function updateNotifications() {
        const ul = document.getElementById("notificationItems");
        ul.innerHTML = "";
        if(notifications.length === 0){
          const li = document.createElement("li");
          li.textContent = "Aucune notification";
          ul.appendChild(li);
          notifBadge.style.display = "none";
          return;
        }
        notifications.forEach(note => {
          const li = document.createElement("li");
          li.textContent = note;
          ul.appendChild(li);
        });
        notifBadge.textContent = notifications.length;
        notifBadge.style.display = notifications.length > 0 ? "inline-block" : "none";
      }

      updateNotifications();

      // Afficher / cacher liste notifications au clic
      notificationBtn.addEventListener("click", () => {
        const isVisible = notificationList.style.display === "block";
        if(isVisible){
          notificationList.style.display = "none";
          notificationBtn.setAttribute("aria-expanded", "false");
          notificationList.setAttribute("hidden", "");
        } else {
          notificationList.style.display = "block";
          notificationBtn.setAttribute("aria-expanded", "true");
          notificationList.removeAttribute("hidden");
        }
      });

      // Cacher notifications si clic en dehors
      document.addEventListener("click", (e) => {
        if(!notificationBtn.contains(e.target) && !notificationList.contains(e.target)){
          notificationList.style.display = "none";
          notificationBtn.setAttribute("aria-expanded", "false");
          notificationList.setAttribute("hidden", "");
        }
      });

      // Échapper ferme notifications
      document.addEventListener("keydown", e => {
        if(e.key === "Escape"){
          notificationList.style.display = "none";
          notificationBtn.setAttribute("aria-expanded", "false");
          notificationList.setAttribute("hidden", "");
          notificationBtn.focus();
        }
      });

    });
</script>
</body>
</html>
